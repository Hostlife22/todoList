(()=>{"use strict";const t="https://61c8c4dcadee460017260de8.mockapi.io/api/v1/tasks",e=()=>fetch(t).then((t=>t.json())).then((t=>(t=>t.map((t=>{let{id:e,...n}=t;return{...n,id:e}})))(t))),n=document.querySelector(".list"),s=(t,e)=>t.done-e.done!=0?t.done-e.done:t.done?new Date(e.finishDate)-new Date(t.finishDate):new Date(e.createDate)-new Date(t.createDate),a=t=>{let{text:e,done:n,id:s}=t;const a=document.createElement("li");a.classList.add("list-item","list__item");const c=(t=>{let{done:e,id:n}=t;const s=document.createElement("input");return s.setAttribute("type","checkbox"),s.setAttribute("data-id",n),s.checked=e,s.classList.add("list-item__checkbox"),s})({done:n,id:s});n&&a.classList.add("list-item_done");const i=document.createElement("span");i.classList.add("list-item__text"),i.textContent=e;const d=document.createElement("button");return d.classList.add("list-item__delete-btn"),a.append(c,i,d),a},c=()=>{e().then((t=>{const e=t.sort(s).map(a);n.innerHTML="",n.append(...e)}))},i=n=>{n.target.classList.contains("list-item__checkbox")&&(n=>{const s=n.target.checked,a=n.target.dataset.id;let i;e().then((t=>{const{text:e,createDate:n}=t.find((t=>t.id===a));i={text:e,createDate:n,done:s,finishDate:s?(new Date).toISOString():null}})).then((()=>((e,n)=>fetch(`${t}/${e}`,{method:"PUT",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(n)}))(a,i))).then((()=>c()))})(n),n.target.classList.contains("list-item__delete-btn")&&(e=>{let n;e.target.closest(".list-item").childNodes.forEach((t=>{t.classList.contains("list-item__checkbox")&&(n=t.dataset.id)})),(e=>fetch(`${t}/${e}`,{method:"DELETE"}))(n).then((()=>c()))})(n)},d=()=>{const e=document.querySelector(".task-input"),n=e.value;if(!n)return;e.value="";var s;(s={text:n,done:!1,createDate:(new Date).toISOString()},fetch(t,{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(s)})).then((()=>c()))};document.addEventListener("DOMContentLoaded",(()=>{e().then((()=>{c()})),document.querySelector(".create-task-btn").addEventListener("click",d),document.querySelector(".list").addEventListener("click",i)}))})();